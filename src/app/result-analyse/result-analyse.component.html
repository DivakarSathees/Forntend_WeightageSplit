<div>
  <h2>Upload Excel file Analyse</h2>

  <!-- <input type="file" id="fileInput" (change)="onFileSelected($event)" class="file-input"/>
  <div class="buttons">
  <button (click)="onUpload()">Upload</button>
  <button (click)="cancel()">Cancel</button>
 </div> -->


<div class="tool" >
  <input type="file" id="fileInput" (change)="onFileSelected($event)" class="file-input" />

  <label for="fileInput" class="file-label">

  <span class="info-icon">‚ùì</span>
  <div class="tooltip">
    Please ensure the Excel file is in the following format:
    <table>
      <tr>
        <th class="th">Test ID</th>
      </tr>
      <tr>
        <td>https://admin.ltimindtree.iamneo.ai/result?testId=***</td>
      </tr>
      <tr>
        <td>https://admin.ltimindtree.iamneo.ai/result?testId=***</td>
      </tr>
    </table>

</div>
</label>
</div>


</div>
<div class="buttons">
  <button (click)="onUpload()">Upload</button>
  <button (click)="cancel()">Cancel</button>
 </div>

<div *ngIf="loading">
  <i class="fa-solid fa-spinner fa-spin-pulse"></i>
</div>

<div *ngIf="table" class="response-container">
  <!-- <a [href]=`http://localhost:8081/download/${678417fdc19cabab646e8b94}` download>Download Excel File</a> -->
  <button (click)="downloadFile(fileId)">Download File</button>



<table  class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Test ID</th>
      <th>TestCases</th>
      <th>Question Data</th>
      <th>Analysis</th>
      <th>Test_Submitted_Time</th>
      <th>SonarAddedTime</th>
      <th>Differnce_In_Submission</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of responseinJson">
      <td>{{ item.name }}</td>
      <td *ngIf="item.test_Id; else blankCell">
        <a [href]="item.test_Id" target="_blank">Link</a>
      </td>
      <ng-template #blankCell>
        <td></td>
      </ng-template>
      <td>
        <button (click)="openModal(item.tcList)">
          View TC List
        </button>
      </td>
      <td>
        <button (click)="openQuestionModal(item.QuestionData)">
        Question Data
        </button>
      </td>
      <td>
        <button (click)="openAnalysisModal(item.aiAnalysis)">
        Analysis Data
        </button>
      </td>
      <td>{{item.Test_Submitted_Time}}</td>
      <td>{{item.SonarAddedTime}}</td>
      <td>{{item.Differnce_In_Submission}}</td>
    </tr>
  </tbody>
</table>


